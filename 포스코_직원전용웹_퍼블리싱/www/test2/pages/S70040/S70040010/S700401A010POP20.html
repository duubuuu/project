<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<!--jquery import-->
	<!-- <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp" rel="stylesheet"> -->
	<link rel="stylesheet" type="text/css" href="../../../css/default.css" />
	<link rel="stylesheet" type="text/css" href="../../../js/vendor/modal/jquery.modal.0.9.1.css" />
	<link rel="stylesheet" type="text/css" href="../../../js/vendor/jquery/jquery-ui.css" />
	<link rel="stylesheet" type="text/css" href="../../../js/vendor/jqgrid/jqGrid.css" />
	<link rel="stylesheet" type="text/css" href="../../../js/jqGrid/css/ui.jqgrid.custom.css" />
	<link rel="stylesheet" type="text/css" href="../../../js/vendor/datepicker/datepicker.css" />
	<!-- <link rel="preconnect" href="https://fonts.gstatic.com"> -->


	<script type="text/javascript" src="../../../js/vendor/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="../../../js/vendor/jquery/jquery-ui.min.js"></script>
	<!--jqGrid import-->
	<script type="text/javascript" src="../../../js/vendor/jqgrid/jqGrid.min.js"></script>
	<script type="text/javascript" src="../../../js/vendor/util/grid.locale-kr.js"></script>
	<script type="text/javascript" src="../../../js/jqGrid/js/posjqgrid.js"></script>
	<script type="text/javascript" src="../../../js/jquery/jquery-migrate-1.2.1.min.js"></script>
	<script type="text/javascript" src="../../../js/bootstarp-datetimepicker/bootstrap-datetimepicker.js"></script>
	<script type="text/javascript" src="../../../js/bootstarp-datetimepicker/bootstrap-datetimepicker.ko.js"></script>

	<!--datepicker import-->
	<script type="text/javascript" src="../../../js/vendor/util/moment.js"></script>
	<script type="text/javascript" src="../../../js/vendor/util/moment.locale-kr.js"></script>
	<script type="text/javascript" src="../../../js/vendor/datepicker/daterangepicker.js"></script>
	<!-- jQuery Modal -->
	<script type="text/javascript" src="../../../js/vendor/modal/jquery-modal.0.9.1.js"></script>
	<script type="text/javascript" src="../../../js/components/modal/modal.js"></script>
	<!--font awesome-->
	<script type="text/javascript" src="../../../js/vendor/fontawesome/all.js"></script>

	<!--DEXT5 -->
	<script type="text/javascript" src="../../../dext5editor/js/dext5editor.js" type="text/javascript"></script>
	<script type="text/javascript" src="../../../sampleEditor/sample.common.js" type="text/javascript"></script>

	<script type="text/javascript" src="../../../js/common_util.js"></script>
	<script type="text/javascript" src="../../../js/project-util/common-comAjax.js"></script>
	<script type="text/javascript" src="../../../js/project-util/common-date.js"></script>
	<script type="text/javascript" src="../../../js/project-util/common-number.js"></script>
	<script type="text/javascript" src="../../../js/project-util/common-string.js"></script>
	<script type="text/javascript" src="../../../js/project-util/common-util.js"></script>
	<script type="text/javascript" src="../../../js/project-util/common-excel.js" charset="utf-8"></script>
	<script type="text/javascript" src="../../../js/project-util/common-comAjax.js" charset="utf-8"></script>

	<script type="text/javascript" src="../../../js/components/datePicker/date.js"></script>
	<script type="text/javascript" src="../../../js/components/panel/tab.js"></script>
	<script type="text/javascript" src="../../../js/components/renderer/render.js"></script>
	<script type="text/javascript" src="../../../js/common.js"></script>
	<!--monthpicker-->
  <script type="text/javascript" src="../../../js/monthpicker/jquery.mtz.monthpicker.js"></script>

	<title>부서별 참여율현황 상세</title>
  <style>
  .ui-jqgrid .ui-jqgrid-htable th {
  height: 0 !important;
  }
  .ui-widget.ui-widget-content {
  border: none;}

  #jqgh_S700201A010_jqGrid_view1_col2,
  #jqgh_S700201A010_jqGrid_view1_col16,
  #jqgh_S700201A010_jqGrid_view1_col29,
  #jqgh_S700201A010_jqGrid_view1_col30,
  #jqgh_S700201A010_jqGrid_view1_col31,
  #jqgh_S700201A010_jqGrid_view1_col32
  {line-height: 17px; }

  /* 사라진 border 추가 */ */
  #S700201A010_jqGrid_view1_col27 {border-right: 1px solid #cccccc !important;}

  .ui-jqgrid .ui-jqgrid-htable .ui-th-div{
  height: auto;
  }
  .ui-jqgrid .ui-jqgrid-bdiv.frozen-bdiv{
  /* padding-bottom: 18px; */
  top: 45px !important;
  }
  .ui-jqgrid-labels jqg-third-row-header{height: 26px !important;}
  .frozen-div{height: 62px !important;}
  .ui-jqgrid .ui-jqgrid-htable th div{margin: 0 !important; }
  .ui-jqgrid .ui-jqgrid-hdiv .ui-jqgrid-htable th .ui-jqgrid-sortable{padding: 0 0;}
  #S700201A010_jqGrid_view1_col3 {border-right: 1px solid #cccccc !important;}
  #jqgh_S700201A010_jqGrid_view1_col2, #jqgh_S700201A010_jqGrid_view1_col3 {top:0 !important;}
  .ui-jqgrid-hbox {
  background-color: #f6f8fa;
  }
  </style>
</head>
	<body id="popup">
		<div id="root">
			<div class="ly-container">
				<div class="ly-wrapper">
					<main class="ly-contents">
						<div class="ly-contents-boxed" style="padding: 15px 26px 25px 29px;">
							<div class="contents-wrapper" id="accordionView0">
								<!--부서별 제안통계 jqgrid start-->
								<div class="table-row" id="S700201A010_jqGrid_container1">
									<table id="S700201A010_jqGrid_view1"></table>
								</div>
						</div>
					</div>
				</main>
			</div>
		</div>
	</div>
	<script src="../../../js/common.js"></script>
	<script src="../../../js/components/panel/tab.js"></script>
	<script src="../../../js/components/renderer/render.js"></script>
	<script src="../../../js/components/pagenate/pager.js"></script>
	<script>
		var linkText = ["작업표준", "변경관리", "위험성평가"];
		var arr = ["#none", "#none", "#none"];
		var arr2 = ["필요", "불필요", "불필요사유"];

		//sample
		var setting =
			"<div class='ui renderer-wrp left mgb4'>" +
			"<a class='mgr10 pxw-80 left' href='" +
			arr[0] +
			"'>" +
			linkText[0] +
			"</a>" +
			"<input type='checkbox' class='ui input checkbox' id='chk1' name='value1' value='001' checked />" +
			"<label for='chk1'>" +
			arr2[0] +
			"</label>" +
			"<input type='checkbox' class='ui input checkbox' id='chk2' name='value1' value='002'/>" +
			"<label for='chk2'>" +
			arr2[1] +
			"</label>" +
			"<input type='text' class='ui input mgl10 pxw-400' placeholder=" +
			arr2[2] +
			" id='001'></input>" +
			"</div>" +
			"<div class='ui renderer-wrp left mgb4'>" +
			"<a class='mgr10 pxw-80 left' href='" +
			arr[1] +
			"'>" +
			linkText[1] +
			"</a>" +
			"<input type='checkbox' class='ui input checkbox' id='chk3' name='value2' value='003'/>" +
			"<label for='chk3'>" +
			arr2[0] +
			"</label>" +
			"<input type='checkbox' class='ui input checkbox' id='chk4' name='value2' value='004' checked/>" +
			"<label for='chk4'>" +
			arr2[1] +
			"</label>" +
			"<input type='text' class='ui input mgl10 pxw-400' placeholder=" +
			arr2[2] +
			" id='003'></input>" +
			"</div>" +
			"<div class='ui renderer-wrp left mgb4'>" +
			"<a class='mgr10 pxw-80 left' href='" +
			arr[2] +
			"'>" +
			linkText[2] +
			"</a>" +
			"<input type='checkbox' class='ui input checkbox' id='chk5' name='value3' value='005' checked/>" +
			"<label for='chk5'>" +
			arr2[0] +
			"</label>" +
			"<input type='checkbox' class='ui input checkbox' id='chk6' name='value3' value='006'/>" +
			"<label for='chk6'>" +
			arr2[1] +
			"</label>" +
			"<input type='text' class='ui input mgl10 pxw-400' placeholder=" +
			arr2[2] +
			" id='005'></input>" +
			"</div>";

		var setting2 =
			"<div class='ui renderer-wrp'><textarea class='pw-100' style='min-height:150px' resizable='no' placeholder='평가결과 우수제안으로 판단시 간략한 사유를 작성해 주시기 바랍니다'></textarea></div>";

		//self재무평가 평가 항목별 디스플레이
		$("#S700201A010_jqGrid_view1").jqGrid({
			datatype: "local", //json
			colModel: [{
					label: "부",
					name: "col1",
					width: 250,
					align: "left",
					sortable: false,
					frozen: false,
					formatter: function windowOpen(cellValue, options, rowObject) {
						var result = '<div class="ui renderer-wrp">' + '<a class="link" onclick="windowOpen()">' + cellValue + " </a></div>";
						return result;
					},
				},
				{
					label: "대상",
					name: "col2",
					width: 100,
					align: "right",
					sortable: false,
					cellattr: cellMerge,
				},
				{
					label: "참여",
					name: "col3",
					index: "col3",
					width: 100,
					align: "right",
					sortable: false,
				},
				{
					label: "참여율<br>(분기)",
					name: "col4",
					width: 100,
					align: "right",
					sortable: false,
          // classes: "none_border"
				},
			],
			data: [
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
					{
					col2: "243",
					col3: "169",
					col4: "69.5",
					},
					{
					col2: "225.5",
					col3: "56",
					col4: "24.8",
					},
					{
					col2: "180",
					col3: "55",
					col4: "30.6",
					},
			],
			viewrecords: true,
			height: 500,
      autowidth: false,
      shrinkToFit: false,
			rowNum: 31,
			// scrollOffset: "auto",
			loadComplete: function() {
				var bg = {
					"background-color": "#e8f2fc"
				};
				var ids = $("#S700201A010_jqGrid_view1").jqGrid("getDataIDs");
				var gridData = $("#S700201A010_jqGrid_view1").jqGrid("getRowData");
				var bg2 = {
					"background-color": "#e8f2fc",
					"text-align": "center",
					"border-right": "none"
				};

				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 1, "col1", "(포항)EIC기술부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 2, "col1", "(포항)FINEX부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 3, "col1", "(포항)FINEX설비부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 4, "col1", "(포항)POSTRIP기술개발추진반", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 5, "col1", "(포항)STS압연부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 6, "col1", "(포항)STS제강부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 7, "col1", "(포항)기술혁신그룹", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 8, "col1", "(포항)냉연부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 9, "col1", "(포항)노재그룹", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 10, "col1", "(포항)발전부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 11, "col1", "(포항)생산기술부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 12, "col1", "(포항)선강설비부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 13, "col1", "(포항)선재부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 14, "col1", "(포항)설비기술부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 15, "col1", "(포항)설비투자그룹", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 16, "col1", "(포항)안전방재그룹", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 17, "col1", "(포항)압연설비부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 18, "col1", "(포항)에너지부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 19, "col1", "(포항)열연부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 20, "col1", "(포항)예비군연대", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 21, "col1", "(포항)인사노무그룹", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 22, "col1", "(포항)전기강판부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 23, "col1", "(포항)제강부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 24, "col1", "(포항)제선부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 25, "col1", "(포항)품질기술부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 26, "col1", "(포항)행정섭외그룹", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 27, "col1", "(포항)화성부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 28, "col1", "(포항)환경자원그룹", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 29, "col1", "(포항)후판부", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 30, "col1", "제철소계", bg);
				$("#S700201A010_jqGrid_view1").jqGrid("setCell", 31, "col1", "총계", bg);
			},
		});
		$("#S700201A010_jqGrid_view1").setGridHeight(550, true);
		$("#S700201A010_jqGrid_view1").jqGrid("setGroupHeaders", {
			useColSpanStyle: true,
			groupHeaders: [{
					startColumnName: 'col2',
					numberOfColumns: 2,
					titleText: '인원'
				},
			]
		});

		function cellMerge(rowId, cellvalue, rowObject, cm, rdata) {
			//같은값 기준으로

			var data = setting;

			if (
				rowObject.col2 == "<div class='ui renderer-wrp left'><input class='ui input pxw-200' type='text'><button class='ui button icon'><i class='fas fa-map-marker-alt'></i></button</div>"
			) {
				return "colspan=2;";
			}

			if (rowObject.col2 == data) {
				return "colspan=6;";
			}

			if (rowObject.col2 == setting2) {
				return "colspan=6;";
			}


			if (rowObject.col2 == "<div class='ui renderer-wrp right'><input class='ui input pxw-120' type='text'><span>점</span></div>") {
				return "colspan=6;"
			}
		}

		function cellMerge2(rowId, cellvalue, rowObject, cm, rdata) {
			//같은값 기준으로
			if (rowObject.col4 == "<div class='ui renderer-wrp right'><input class='ui input pxw-120' type='text'><span>점</span></div>") {
				return "colspan=3;";
			}
		}

		$(window)
			.bind("resize", function() {
				$("#S700201A010_jqGrid_view1").setGridWidth($("#S700201A010_jqGrid_container1").width(), true);
			})
			.trigger("resize");

		function windowOpen() {
			window.open(
				"./S700303A010POP01.html",
				"07_pop",
				"width=1040, height=600, left=50%, top=50%, toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no"
			);
		}
	</script>
</body>

</html>
